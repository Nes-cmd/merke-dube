import{u as N,r as m,v as x,R as T,j as s,$}from"./app-J7HsqsI9.js";import{S as z,A as D,R as L}from"./AuthenticatedLayout-knoU74ve.js";import{s as a}from"./index-DifNHl01.js";import{T as f,B as p}from"./EllipsisOutlined-z3H18_gv.js";import{R as M}from"./EditOutlined-DKX5yRBc.js";import{P as _}from"./index-BUOojXlC.js";import{R as F}from"./DeleteOutlined-Cw2q4Eec.js";import{C as P}from"./index-C9h9lfZs.js";import{I as l}from"./index-B4GooqbK.js";import{R as W}from"./SearchOutlined-BswwKShY.js";import{F as B}from"./Table-C7mTbJGI.js";import{R as O}from"./index-DY6NS2TT.js";import{M as V}from"./index-DcVtvz2k.js";import{F as n}from"./index-BqbYBDii.js";import{R as q}from"./PhoneOutlined-EIDEKR6-.js";import{R as K,a as Y}from"./MailOutlined-BKpRgYQV.js";import{R as G}from"./MenuOutlined-CPzlee0P.js";/* empty css            */import"./move-C0wxGgXZ.js";import"./BaseInput-CPkyeE5i.js";import"./DownOutlined-DYFiL0VQ.js";import"./index-BwMG-dte.js";import"./EyeOutlined-DkxJknix.js";import"./styleChecker-Ds4zr2-F.js";import"./addEventListener-BJOWCriI.js";import"./index-DmrLIlKl.js";import"./index-CUWDS_la.js";import"./index-BPj3NJfq.js";import"./row-CrguNsy7.js";const{TextArea:H}=l,Ie=({auth:j,customers:C,flash:i})=>{const{t}=N(),[c,v]=m.useState(""),[g,d]=m.useState(!1),[h,u]=m.useState(!1),[J,w]=m.useState(window.innerWidth),r=x({id:"",name:"",phone:"",email:"",address:"",notes:""}),{delete:R}=x();m.useEffect(()=>{const e=()=>{w(window.innerWidth)};return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]),T.useEffect(()=>{i.message&&a.success(i.message),i.error&&a.error(i.error)},[i]);const S=()=>{r.post(route("customers.store"),{onSuccess:()=>{d(!1),r.reset(),a.success(t("Customer added successfully"))},onError:e=>{console.error(e)}})},E=()=>{r.put(route("customers.update",r.data.id),{onSuccess:()=>{d(!1),r.reset(),u(!1),a.success(t("Customer updated successfully"))},onError:e=>{console.error(e)}})},I=e=>{R(route("customers.destroy",e),{onSuccess:()=>{a.success(t("Customer deleted successfully"))},onError:()=>{a.error(t("Failed to delete customer"))}})},y=e=>{r.setData({id:e.id,name:e.name,phone:e.phone||"",email:e.email||"",address:e.address||"",notes:e.notes||""}),u(!0),d(!0)},b=()=>{r.reset(),u(!1),d(!0)},A=C.filter(e=>e.name.toLowerCase().includes(c.toLowerCase())||e.phone&&e.phone.includes(c)||e.email&&e.email.toLowerCase().includes(c.toLowerCase())),k=[{title:t("Name"),dataIndex:"name",key:"name",render:(e,o)=>s.jsx("a",{href:route("customers.show",o.id),children:e}),sorter:(e,o)=>e.name.localeCompare(o.name)},{title:t("Phone"),dataIndex:"phone",key:"phone",responsive:["md"]},{title:t("Email"),dataIndex:"email",key:"email",responsive:["lg"]},{title:t("Sales"),dataIndex:"sales_count",key:"sales_count",sorter:(e,o)=>e.sales_count-o.sales_count},{title:t("Actions"),key:"actions",render:(e,o)=>s.jsxs(z,{children:[s.jsx(f,{title:t("Edit"),children:s.jsx(p,{icon:s.jsx(M,{}),onClick:()=>y(o),size:"small"})}),s.jsx(_,{title:t("Are you sure you want to delete this customer?"),onConfirm:()=>I(o.id),okText:t("Yes"),cancelText:t("No"),okButtonProps:{danger:!0},disabled:o.sales_count>0,children:s.jsx(f,{title:o.sales_count>0?t("Cannot delete customer with sales"):t("Delete"),children:s.jsx(p,{danger:!0,icon:s.jsx(F,{}),disabled:o.sales_count>0,size:"small"})})})]})}];return s.jsxs(D,{user:j.user,children:[s.jsx($,{title:t("Customers")}),s.jsx("div",{className:"py-6 mx-auto max-w-7xl sm:px-6 lg:px-8",children:s.jsxs(P,{title:t("Customers"),extra:s.jsx(p,{type:"primary",icon:s.jsx(O,{}),onClick:b,className:"bg-primary-500",children:t("Add Customer")}),children:[s.jsx("div",{className:"mb-4",children:s.jsx(l,{placeholder:t("Search customers..."),prefix:s.jsx(W,{}),value:c,onChange:e=>v(e.target.value),allowClear:!0})}),s.jsx("div",{className:"overflow-x-auto",children:s.jsx(B,{dataSource:A,columns:k,rowKey:"id",pagination:{pageSize:10,showSizeChanger:!0,pageSizeOptions:["10","20","50"],showTotal:(e,o)=>t("{{range0}}-{{range1}} of {{total}} customers",{range0:o[0],range1:o[1],total:e})},scroll:{x:"max-content"}})})]})}),s.jsx(V,{title:t(h?"Edit Customer":"Add New Customer"),open:g,onOk:h?E:S,onCancel:()=>{d(!1),u(!1),r.reset()},confirmLoading:r.processing,children:s.jsxs(n,{layout:"vertical",children:[s.jsx(n.Item,{label:t("Name"),validateStatus:r.errors.name?"error":"",help:r.errors.name,required:!0,children:s.jsx(l,{prefix:s.jsx(L,{}),value:r.data.name,onChange:e=>r.setData("name",e.target.value),placeholder:t("Enter customer name")})}),s.jsx(n.Item,{label:t("Phone Number"),validateStatus:r.errors.phone?"error":"",help:r.errors.phone,children:s.jsx(l,{prefix:s.jsx(q,{}),value:r.data.phone,onChange:e=>r.setData("phone",e.target.value),placeholder:t("Enter phone number")})}),s.jsx(n.Item,{label:t("Email"),validateStatus:r.errors.email?"error":"",help:r.errors.email,children:s.jsx(l,{prefix:s.jsx(K,{}),value:r.data.email,onChange:e=>r.setData("email",e.target.value),placeholder:t("Enter email address")})}),s.jsx(n.Item,{label:t("Address"),validateStatus:r.errors.address?"error":"",help:r.errors.address,children:s.jsx(l,{prefix:s.jsx(G,{}),value:r.data.address,onChange:e=>r.setData("address",e.target.value),placeholder:t("Enter address")})}),s.jsx(n.Item,{label:t("Notes"),validateStatus:r.errors.notes?"error":"",help:r.errors.notes,children:s.jsx(H,{prefix:s.jsx(Y,{}),value:r.data.notes,onChange:e=>r.setData("notes",e.target.value),placeholder:t("Additional notes"),rows:4})})]})})]})};export{Ie as default};
