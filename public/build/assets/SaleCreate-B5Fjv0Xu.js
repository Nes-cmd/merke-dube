import{u as F,r as x,v as A,j as e,$ as P}from"./app-CRCs68rE.js";import{A as q,R as O}from"./AuthenticatedLayout-C40XysMS.js";import{C as R}from"./index-CC03SSas.js";import{F as l}from"./index-dGg0aISM.js";import{S as u,s as E}from"./index-BzAFGkKR.js";import{T as c}from"./index-BZhV6rLF.js";import{I as m}from"./index-ySzzkY_X.js";import{B as j}from"./EllipsisOutlined-BN-ZZJYF.js";import{R as L}from"./index-Bx08ww7s.js";import{M as T}from"./index-BaIi0PFn.js";import{R as M}from"./PhoneOutlined-CUzn0tLt.js";/* empty css            */import"./MenuOutlined-CSJrGBAl.js";import"./move-DVxTIaS1.js";import"./row-vOp5nfUz.js";import"./index-BLSJKx67.js";import"./BaseInput-CfSJKDsY.js";import"./SearchOutlined-DiR9Qobr.js";import"./DownOutlined-V-h3AYIb.js";import"./EyeOutlined-_2BUD01o.js";const{Option:$}=u,se=({auth:v,products:h,customers:f})=>{const{t:a}=F(),[n,C]=x.useState(null),[g,p]=x.useState(!1),{data:r,setData:i,post:S,processing:b,errors:o}=A({item_id:"",item_name:"",quantity:1,total:0,paid:0,credit:0,customer_name:"",customer_phone:"",note:"",customer_id:""}),w=t=>{const s=h.find(d=>d.id===t);if(C(s),s){const d=s.price||0;i({...r,item_id:s.id,item_name:s.name,total:d,paid:0,credit:d})}},_=t=>{if(n&&t){const s=(n.price||0)*t;i({...r,quantity:t,total:s,credit:s-r.paid})}else i({...r,quantity:t||1})},y=t=>{const s=t||0;i({...r,paid:s,credit:r.total-s})},I=()=>{S(route("sales.store"),{onSuccess:()=>{E.success(a("Sale added successfully!")),window.location.href=route("sales.index")}})},N=()=>{};return e.jsxs(q,{user:v.user,header:e.jsx("h2",{className:"font-semibold text-xl text-gray-800 leading-tight",children:a("Add Sale")}),children:[e.jsx(P,{title:a("Add Sale")}),e.jsx("div",{className:"py-12",children:e.jsx("div",{className:"max-w-7xl mx-auto sm:px-6 lg:px-8",children:e.jsx("div",{className:"bg-white overflow-hidden shadow-sm sm:rounded-lg p-6",children:e.jsx(R,{title:a("Add New Sale"),className:"mb-6",children:e.jsxs(l,{layout:"vertical",onFinish:I,children:[e.jsx(l.Item,{label:a("Product"),required:!0,validateStatus:o.item_id?"error":"",help:o.item_id,children:e.jsx(u,{showSearch:!0,placeholder:a("Select a product"),optionFilterProp:"children",value:r.item_id||void 0,onChange:w,filterOption:(t,s)=>s.children.toLowerCase().indexOf(t.toLowerCase())>=0,className:"w-full",children:h.map(t=>e.jsxs($,{value:t.id,children:[t.name," - ",t.quantity," ",a("available")]},t.id))})}),e.jsx(l.Item,{label:a("Quantity"),validateStatus:o.quantity?"error":"",help:o.quantity,children:e.jsx(c,{min:1,max:(n==null?void 0:n.quantity)||1,value:r.quantity,onChange:_,className:"w-full"})}),e.jsx(l.Item,{label:a("Total Amount"),validateStatus:o.total?"error":"",help:o.total,children:e.jsx(c,{min:0,step:.01,value:r.total,onChange:t=>i("total",t),className:"w-full"})}),e.jsx(l.Item,{label:a("Amount Paid"),validateStatus:o.paid?"error":"",help:o.paid,children:e.jsx(c,{min:0,max:r.total,step:.01,value:r.paid,onChange:y,className:"w-full"})}),e.jsx(l.Item,{label:a("Credit"),children:e.jsx(c,{value:r.credit,disabled:!0,className:"w-full bg-gray-100"})}),e.jsx(l.Item,{label:a("Customer"),validateStatus:o.customer_id?"error":"",help:o.customer_id,children:e.jsx(u,{showSearch:!0,placeholder:a("Select a customer"),optionFilterProp:"children",value:r.customer_id,onChange:t=>i("customer_id",t),filterOption:(t,s)=>s.children.toLowerCase().indexOf(t.toLowerCase())>=0,allowClear:!0,children:f.map(t=>e.jsxs(u.Option,{value:t.id,children:[t.name," ",t.phone?`- ${t.phone}`:""]},t.id))})}),e.jsx(l.Item,{label:a("Customer Name"),validateStatus:o.customer_name?"error":"",help:o.customer_name,children:e.jsx(m,{value:r.customer_name,onChange:t=>i("customer_name",t.target.value),placeholder:a("Enter customer name (optional)")})}),e.jsx(l.Item,{label:a("Customer Phone"),validateStatus:o.customer_phone?"error":"",help:o.customer_phone,children:e.jsx(m,{value:r.customer_phone,onChange:t=>i("customer_phone",t.target.value),placeholder:a("Enter customer phone (optional)")})}),e.jsx(l.Item,{label:a("Note"),validateStatus:o.note?"error":"",help:o.note,children:e.jsx(m.TextArea,{value:r.note,onChange:t=>i("note",t.target.value),rows:4,placeholder:a("Add a note (optional)")})}),e.jsx(l.Item,{children:e.jsx(j,{type:"dashed",icon:e.jsx(L,{}),onClick:()=>p(!0),children:a("Add New Customer")})}),e.jsx(l.Item,{children:e.jsx(j,{type:"primary",htmlType:"submit",loading:b,className:"bg-primary-500",children:a("Add Sale")})})]})})})})}),e.jsx(T,{title:a("Add New Customer"),open:g,onOk:N,onCancel:()=>p(!1),confirmLoading:customerForm.processing,children:e.jsxs(l,{layout:"vertical",children:[e.jsx(l.Item,{label:a("Name"),validateStatus:customerForm.errors.name?"error":"",help:customerForm.errors.name,required:!0,children:e.jsx(m,{prefix:e.jsx(O,{}),value:customerForm.data.name,onChange:t=>customerForm.setData("name",t.target.value),placeholder:a("Enter customer name")})}),e.jsx(l.Item,{label:a("Phone Number"),validateStatus:customerForm.errors.phone?"error":"",help:customerForm.errors.phone,children:e.jsx(m,{prefix:e.jsx(M,{}),value:customerForm.data.phone,onChange:t=>customerForm.setData("phone",t.target.value),placeholder:a("Enter phone number")})})]})})]})};export{se as default};
