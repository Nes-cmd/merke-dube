import{u as L,r as c,v as Q,j as e,$ as W,Y as z}from"./app-CRCs68rE.js";import{A as H,b as J}from"./AuthenticatedLayout-C40XysMS.js";import{d as b}from"./dayjs.min-C6U6SvUP.js";import{I as X,a as Z}from"./ImageUploader-Jba_c6C1.js";import{B as p}from"./EllipsisOutlined-BN-ZZJYF.js";import{R as ee}from"./ArrowLeftOutlined-BkQCZah1.js";import{R as ae}from"./FileImageOutlined-BWp7llFB.js";import{T as k}from"./index-Bx08ww7s.js";import{C as _}from"./index-CC03SSas.js";import{F as l}from"./index-dGg0aISM.js";import{I as u}from"./index-ySzzkY_X.js";import{S as x,s as d}from"./index-BzAFGkKR.js";import{T as I}from"./index-BZhV6rLF.js";import{D as re}from"./index-BejIUwt0.js";import{D as S}from"./index-DU48blS8.js";import{R as te}from"./SaveOutlined-CmUJv9ef.js";import{R as se}from"./index-CgK7WY5N.js";import{M as ie}from"./index-BaIi0PFn.js";/* empty css            */import"./MenuOutlined-CSJrGBAl.js";import"./move-DVxTIaS1.js";import"./index-DDqP2XAy.js";import"./EyeOutlined-_2BUD01o.js";import"./BaseInput-CfSJKDsY.js";import"./addEventListener-BWQubspr.js";import"./index-glDcQ16U.js";import"./DeleteOutlined-5vXBziNG.js";import"./row-vOp5nfUz.js";import"./index-BLSJKx67.js";import"./SearchOutlined-DiR9Qobr.js";import"./DownOutlined-V-h3AYIb.js";const{Option:m}=x,{TextArea:le}=u,{TabPane:C}=k,Fe=({auth:E,product:s,categories:D,warehouses:N,suppliers:w,images:P})=>{const{t:r}=L(),[v,g]=c.useState(P||[]),[R,h]=c.useState(!1),[T,q]=c.useState("basic"),[j,M]=c.useState(s.manufacture_date?b(s.manufacture_date):null),[U,V]=c.useState(s.expiry_date?b(s.expiry_date):null),{data:o,setData:n,put:F,processing:$,errors:t}=Q({name:s.name||"",remark:s.remark||"",quantity:s.quantity||0,unit_price:s.unit_price||0,category_id:s.category_id||"",store_id:s.store_id||"",supplier_id:s.supplier_id||"",sku:s.sku||"",code:s.code||"",batch_number:s.batch_number||"",manufacture_date:s.manufacture_date||null,expiry_date:s.expiry_date||null}),A=()=>{F(route("products.update",s.id),{onSuccess:()=>{d.success(r("Product updated successfully!"))}})},B=(a,i)=>{M(a),n("manufacture_date",i)},K=(a,i)=>{V(a),n("expiry_date",i)},O=a=>{window.confirm(r("Are you sure you want to delete this image?"))&&axios.delete(route("products.delete-image",[s.id,a])).then(i=>{d.success(r("Image deleted successfully")),g(v.filter(y=>y.id!==a))}).catch(i=>{console.error("Error deleting image:",i),d.error(r("Failed to delete image"))})},Y=a=>{axios.post(route("products.set-primary-image",[s.id,a])).then(i=>{d.success(r("Primary image updated")),g(y=>y.map(f=>({...f,is_primary:f.id===a})))}).catch(i=>{console.error("Error setting primary image:",i),d.error(r("Failed to update primary image"))})},G=a=>{axios.post(route("products.update-image-order",s.id),{order:a}).then(i=>{d.success(r("Image order updated"))}).catch(i=>{console.error("Error updating image order:",i),d.error(r("Failed to update image order"))})};return e.jsxs(H,{user:E.user,header:e.jsx("h2",{className:"font-semibold text-xl text-gray-800 leading-tight",children:r("Edit Product")}),children:[e.jsx(W,{title:r("Edit Product")}),e.jsx("div",{className:"py-12",children:e.jsx("div",{className:"max-w-7xl mx-auto sm:px-6 lg:px-8",children:e.jsxs("div",{className:"bg-white overflow-hidden shadow-sm sm:rounded-lg p-6",children:[e.jsxs("div",{className:"mb-6 flex justify-between items-center",children:[e.jsx(z,{href:route("products.show",s.id),children:e.jsx(p,{icon:e.jsx(ee,{}),children:r("Back to Product")})}),e.jsx(p,{type:"primary",icon:e.jsx(ae,{}),onClick:()=>h(!0),children:r("Upload Images")})]}),e.jsxs(k,{activeKey:T,onChange:q,children:[e.jsx(C,{tab:r("Basic Information"),children:e.jsx(_,{children:e.jsxs(l,{layout:"vertical",onFinish:A,initialValues:o,children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(l.Item,{label:r("Product Name"),validateStatus:t.name?"error":"",help:t.name,required:!0,children:e.jsx(u,{value:o.name,onChange:a=>n("name",a.target.value),placeholder:r("Enter product name")})}),e.jsx(l.Item,{label:r("Remarks"),validateStatus:t.remark?"error":"",help:t.remark,children:e.jsx(le,{value:o.remark,onChange:a=>n("remark",a.target.value),rows:3,placeholder:r("Enter product remarks")})}),e.jsx(l.Item,{label:r("Category"),validateStatus:t.category_id?"error":"",help:t.category_id,children:e.jsxs(x,{value:o.category_id,onChange:a=>n("category_id",a),placeholder:r("Select category"),children:[e.jsx(m,{value:"",children:r("None")}),D.map(a=>e.jsx(m,{value:a.id,children:a.name},a.id))]})}),e.jsx(l.Item,{label:r("Warehouse"),validateStatus:t.store_id?"error":"",help:t.store_id,required:!0,children:e.jsx(x,{value:o.store_id,onChange:a=>n("store_id",a),placeholder:r("Select warehouse"),children:N.map(a=>e.jsx(m,{value:a.id,children:a.name},a.id))})})]}),e.jsxs("div",{children:[e.jsx(l.Item,{label:r("Quantity"),validateStatus:t.quantity?"error":"",help:t.quantity,children:e.jsx(I,{min:0,value:o.quantity,onChange:a=>n("quantity",a),style:{width:"100%"}})}),e.jsx(l.Item,{label:r("Unit Price"),validateStatus:t.unit_price?"error":"",help:t.unit_price,children:e.jsx(I,{min:0,step:.01,value:o.unit_price,onChange:a=>n("unit_price",a),style:{width:"100%"}})}),e.jsx(l.Item,{label:r("Supplier"),validateStatus:t.supplier_id?"error":"",help:t.supplier_id,children:e.jsxs(x,{value:o.supplier_id,onChange:a=>n("supplier_id",a),placeholder:r("Select supplier"),children:[e.jsx(m,{value:"",children:r("None")}),w.map(a=>e.jsx(m,{value:a.id,children:a.name},a.id))]})})]})]}),e.jsx(re,{}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(l.Item,{label:r("SKU"),validateStatus:t.sku?"error":"",help:t.sku,children:e.jsx(u,{value:o.sku,onChange:a=>n("sku",a.target.value),placeholder:r("Enter SKU"),prefix:e.jsx(J,{})})}),e.jsx(l.Item,{label:r("Batch Number"),validateStatus:t.batch_number?"error":"",help:t.batch_number,children:e.jsx(u,{value:o.batch_number,onChange:a=>n("batch_number",a.target.value),placeholder:r("Enter batch number")})})]}),e.jsxs("div",{children:[e.jsx(l.Item,{label:r("Code"),validateStatus:t.code?"error":"",help:t.code,children:e.jsx(u,{value:o.code,onChange:a=>n("code",a.target.value),placeholder:r("Enter code")})}),e.jsx(l.Item,{label:r("Manufacture Date"),validateStatus:t.manufacture_date?"error":"",help:t.manufacture_date,children:e.jsx(S,{style:{width:"100%"},value:j,onChange:B,placeholder:r("Select manufacture date")})}),e.jsx(l.Item,{label:r("Expiry Date"),validateStatus:t.expiry_date?"error":"",help:t.expiry_date,children:e.jsx(S,{style:{width:"100%"},value:U,onChange:K,placeholder:r("Select expiry date"),disabledDate:a=>j&&a&&a<j})})]})]}),e.jsx("div",{className:"flex justify-end mt-6",children:e.jsx(p,{type:"primary",htmlType:"submit",icon:e.jsx(te,{}),loading:$,className:"bg-primary-500",children:r("Save Changes")})})]})})},"basic"),e.jsx(C,{tab:r("Images"),children:e.jsxs(_,{children:[e.jsx("div",{className:"mb-4",children:e.jsx(p,{type:"primary",icon:e.jsx(se,{}),onClick:()=>h(!0),children:r("Upload New Images")})}),e.jsx(X,{images:v,onDelete:O,onSetPrimary:Y,onOrderChange:G,canEdit:!0})]})},"images")]}),e.jsx(ie,{title:r("Upload Images"),open:R,onCancel:()=>h(!1),footer:null,width:800,children:e.jsx(Z,{itemId:s.id,onSuccess:a=>{g(i=>[...i,...a]),h(!1)}})})]})})})]})};export{Fe as default};
