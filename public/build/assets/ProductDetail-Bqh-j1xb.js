import{u as A,r as u,j as r,$ as w,Y as c,e as x}from"./app-J7HsqsI9.js";import{A as P,S as y}from"./AuthenticatedLayout-knoU74ve.js";import{I as C,a as k}from"./ImageUploader-DutZ6zxd.js";import{d as l}from"./dayjs.min-Dx7zJ0Eh.js";import{B as m}from"./EllipsisOutlined-z3H18_gv.js";import{R as v}from"./ArrowLeftOutlined-DpByDi2B.js";import{R as B}from"./ReloadOutlined-Cw7nNdxE.js";import{R as T}from"./index-DYikMKze.js";import{R as E}from"./EditOutlined-DKX5yRBc.js";import{C as F}from"./index-C9h9lfZs.js";import{D as s}from"./index-DTjrx_-W.js";import{T as j}from"./index-DY6NS2TT.js";import{F as U}from"./Table-C7mTbJGI.js";import{M as $}from"./index-DcVtvz2k.js";import{T as L}from"./index-Dz6IsBsV.js";import{s as n}from"./index-DifNHl01.js";/* empty css            */import"./MenuOutlined-CPzlee0P.js";import"./move-C0wxGgXZ.js";import"./index-C5YUp4dD.js";import"./EyeOutlined-DkxJknix.js";import"./BaseInput-CPkyeE5i.js";import"./addEventListener-BJOWCriI.js";import"./index-Tnbu6Yrc.js";import"./DeleteOutlined-Cw2q4Eec.js";import"./SearchOutlined-BswwKShY.js";import"./styleChecker-Ds4zr2-F.js";import"./DownOutlined-DYFiL0VQ.js";import"./index-DmrLIlKl.js";import"./index-CUWDS_la.js";import"./index-BPj3NJfq.js";const{TabPane:p}=j,ge=({auth:g,product:t,refills:I,images:b})=>{const{t:e}=A(),[D,h]=u.useState(!1),[Y,d]=u.useState(b||[]),N=a=>{if(!a)return null;const i={completed:"green",pending:"orange",expired:"red",expiring_soon:"gold"},o={completed:e("Completed"),pending:e("Pending"),expired:e("Expired"),expiring_soon:e("Expiring Soon")};return r.jsx(L,{color:i[a.toLowerCase()],children:o[a.toLowerCase()]})},_=async a=>{try{await x.delete(route("products.delete-image",[t.id,a])),d(i=>i.filter(o=>o.id!==a)),n.success(e("Image deleted successfully"))}catch(i){console.error("Delete failed:",i),n.error(e("Failed to delete image"))}},M=async a=>{try{await x.post(route("products.set-primary-image",[t.id,a])),d(i=>i.map(o=>({...o,is_primary:o.id===a}))),n.success(e("Primary image updated"))}catch(i){console.error("Set primary failed:",i),n.error(e("Failed to update primary image"))}},S=async a=>{try{await x.post(route("products.update-image-order",t.id),{images:a}),d(a)}catch(i){console.error("Reorder failed:",i),n.error(e("Failed to update image order"))}},R=[{title:e("Date"),dataIndex:"created_at",key:"date",render:a=>l(a).format("YYYY-MM-DD HH:mm")},{title:e("Quantity"),dataIndex:"quantity",key:"quantity"},{title:e("Batch"),dataIndex:"batch_number",key:"batch",render:a=>a||e("N/A")},{title:e("Expiry"),dataIndex:"expiry_date",key:"expiry",render:a=>a?l(a).format("YYYY-MM-DD"):e("N/A")},{title:e("Supplier"),dataIndex:["supplier","name"],key:"supplier",render:(a,i)=>i.supplier?i.supplier.name:e("N/A")},{title:e("Notes"),dataIndex:"notes",key:"notes",render:a=>a||e("N/A")}],f=t.expiry_date?l(t.expiry_date).isBefore(l())?"expired":l(t.expiry_date).isBefore(l().add(30,"day"))?"expiring_soon":null:null;return r.jsxs(P,{user:g.user,header:r.jsx("h2",{className:"font-semibold text-xl text-gray-800 leading-tight",children:e("Product Details")}),children:[r.jsx(w,{title:e("Product Details")}),r.jsx("div",{className:"py-12",children:r.jsx("div",{className:"max-w-7xl mx-auto sm:px-6 lg:px-8",children:r.jsxs("div",{className:"bg-white overflow-hidden shadow-sm sm:rounded-lg p-6",children:[r.jsxs("div",{className:"mb-6 flex justify-between items-center",children:[r.jsx(c,{href:route("products.index"),children:r.jsx(m,{icon:r.jsx(v,{}),children:e("Back to Products")})}),r.jsxs(y,{children:[r.jsx(c,{href:route("products.refill",t.id),children:r.jsx(m,{type:"primary",icon:r.jsx(B,{}),children:e("Refill Stock")})}),r.jsx(m,{type:"primary",icon:r.jsx(T,{}),onClick:()=>h(!0),children:e("Manage Images")}),r.jsx(c,{href:route("products.edit",t.id),children:r.jsx(m,{type:"default",icon:r.jsx(E,{}),children:e("Edit")})})]})]}),r.jsx(F,{title:t.name,className:"mb-6",children:r.jsxs(s,{bordered:!0,column:{xxl:4,xl:3,lg:3,md:2,sm:1,xs:1},children:[r.jsx(s.Item,{label:e("ID"),children:t.id}),r.jsx(s.Item,{label:e("SKU"),children:t.sku||e("N/A")}),r.jsx(s.Item,{label:e("Barcode"),children:t.barcode||e("N/A")}),r.jsx(s.Item,{label:e("Quantity"),children:t.quantity}),r.jsx(s.Item,{label:e("Unit Price"),children:parseFloat(t.unit_price).toFixed(2)}),r.jsx(s.Item,{label:e("Category"),children:t.category?t.category.name:e("Uncategorized")}),r.jsx(s.Item,{label:e("Warehouse"),children:t.store?t.store.name:e("N/A")}),r.jsx(s.Item,{label:e("Supplier"),children:t.supplier?t.supplier.name:e("N/A")}),r.jsx(s.Item,{label:e("Batch Number"),children:t.batch_number||e("N/A")}),r.jsx(s.Item,{label:e("Manufacture Date"),children:t.manufacture_date?l(t.manufacture_date).format("YYYY-MM-DD"):e("N/A")}),r.jsx(s.Item,{label:e("Expiry Date"),children:r.jsxs(y,{children:[t.expiry_date?l(t.expiry_date).format("YYYY-MM-DD"):e("N/A"),f&&N(f)]})}),r.jsx(s.Item,{label:e("Refill Count"),span:2,children:t.refill_count}),r.jsx(s.Item,{label:e("Last Refill"),children:t.last_refill_date?l(t.last_refill_date).format("YYYY-MM-DD"):e("Never")}),r.jsx(s.Item,{label:e("Description"),span:3,children:t.description||e("No description provided")})]})}),r.jsxs(j,{defaultActiveKey:"1",children:[r.jsx(p,{tab:e("Images"),children:r.jsx(C,{images:Y,onDelete:_,onSetPrimary:M,onReorder:S})},"1"),r.jsx(p,{tab:e("Refill History"),children:r.jsx(U,{columns:R,dataSource:I,rowKey:"id",pagination:{pageSize:10}})},"2"),r.jsx(p,{tab:e("Inventory Movement"),children:r.jsx("p",{children:e("Coming soon")})},"3")]}),r.jsx($,{title:e("Upload Product Images"),open:D,onCancel:()=>h(!1),footer:null,width:800,children:r.jsx(k,{itemId:t.id,onSuccess:a=>{d(i=>[...i,...a])}})})]})})})]})};export{ge as default};
