import{r as a,_ as q,u as se,j as e,Y as l,$ as ie,e as ae}from"./app-CRCs68rE.js";import{S as R,D as T,A as ne}from"./AuthenticatedLayout-C40XysMS.js";import"./dayjs.min-C6U6SvUP.js";import{F as u}from"./index-dGg0aISM.js";import{A as E}from"./index-uhcIM77l.js";import{I as oe}from"./index-DDqP2XAy.js";import{R as le}from"./FileImageOutlined-BWp7llFB.js";import{T as ce}from"./index-Bq9eUj9p.js";import{B as de}from"./index-glDcQ16U.js";import{I as O,T as x,B as o}from"./EllipsisOutlined-BN-ZZJYF.js";import{R as $}from"./ReloadOutlined-CUNTnrBl.js";import{R as b}from"./EditOutlined-CgMcCK14.js";import{R as ue}from"./EyeOutlined-_2BUD01o.js";import{R as me,T as D}from"./index-Bx08ww7s.js";import{R as pe}from"./AppstoreOutlined-BbRxsK_y.js";import{R as he}from"./MenuOutlined-CSJrGBAl.js";import{F as fe}from"./Table-Cs1RrENC.js";import{M as xe}from"./index-BaIi0PFn.js";import{T as F}from"./index-BZhV6rLF.js";import{I as N}from"./index-ySzzkY_X.js";import{R as B}from"./SearchOutlined-DiR9Qobr.js";import{s as A}from"./index-BzAFGkKR.js";/* empty css            */import"./move-DVxTIaS1.js";import"./row-vOp5nfUz.js";import"./index-BLSJKx67.js";import"./BaseInput-CfSJKDsY.js";import"./index-BY1PwM7l.js";import"./addEventListener-BWQubspr.js";import"./styleChecker-D6B7uQ6j.js";import"./DownOutlined-V-h3AYIb.js";import"./index-DZxQkxSO.js";import"./index-CUWDS_la.js";var je={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M456 231a56 56 0 10112 0 56 56 0 10-112 0zm0 280a56 56 0 10112 0 56 56 0 10-112 0zm0 280a56 56 0 10112 0 56 56 0 10-112 0z"}}]},name:"more",theme:"outlined"},ge=function(d,n){return a.createElement(O,q({},d,{ref:n,icon:je}))},M=a.forwardRef(ge),ye={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M696 480H544V328c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v152H328c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h152v152c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V544h152c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8z"}},{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}}]},name:"plus-circle",theme:"outlined"},we=function(d,n){return a.createElement(O,q({},d,{ref:n,icon:ye}))},W=a.forwardRef(we);const{TabPane:_}=D,{Text:ve}=ce,rt=({auth:j,products:d,warehouses:n})=>{const{t:r}=se(),[Re,S]=a.useState(""),[V,L]=a.useState(""),I=a.useRef(null),[U,g]=a.useState(!1),[m,H]=a.useState(null),[p,Q]=a.useState("all"),[Y,k]=a.useState(d),[G,K]=a.useState(typeof window<"u"?window.innerWidth:0);a.useEffect(()=>{const t=()=>K(window.innerWidth);return window.addEventListener("resize",t),()=>window.removeEventListener("resize",t)},[]);const y=G<768,[w]=u.useForm(),v=d.map(t=>{var i,c,h;const s=((i=t.images)==null?void 0:i.find(f=>f.is_primary))||((c=t.images)==null?void 0:c[0]);return{...t,key:t.id,primaryImageUrl:s?`/storage/${s.image_path}`:null,statusText:X(t.status),statusColor:ee(t.status),warehouseName:((h=t.store)==null?void 0:h.name)||r("No Warehouse")}});a.useEffect(()=>{k(p==="all"?v:v.filter(t=>t.store_id===parseInt(p)))},[p,v]);const Z=t=>{Q(t)},C=(t,s,i)=>{s(),S(t[0]),L(i)},J=t=>{t(),S("")},z=t=>({filterDropdown:({setSelectedKeys:s,selectedKeys:i,confirm:c,clearFilters:h})=>e.jsxs("div",{style:{padding:8},children:[e.jsx(N,{ref:I,placeholder:`${r("Search")} ${r(t)}`,value:i[0],onChange:f=>s(f.target.value?[f.target.value]:[]),onPressEnter:()=>C(i,c,t),style:{width:188,marginBottom:8,display:"block"}}),e.jsxs(R,{children:[e.jsx(o,{type:"primary",onClick:()=>C(i,c,t),icon:e.jsx(B,{}),size:"small",style:{width:90},children:r("Search")}),e.jsx(o,{onClick:()=>J(h),size:"small",style:{width:90},children:r("Reset")})]})]}),filterIcon:s=>e.jsx(B,{style:{color:s?"#1890ff":void 0}}),onFilter:(s,i)=>i[t]?i[t].toString().toLowerCase().includes(s.toLowerCase()):"",onFilterDropdownVisibleChange:s=>{s&&setTimeout(()=>{var i;return(i=I.current)==null?void 0:i.select()},100)},render:s=>V===t?e.jsx("span",{style:{fontWeight:"bold"},children:s}):s});function X(t){switch(t){case 1:return r("Pending");case 2:return r("Completed");case 3:return r("Cancelled");default:return r("Unknown")}}function ee(t){switch(t){case 1:return"orange";case 2:return"green";case 3:return"red";default:return"default"}}const P=t=>{H(t),g(!0),w.resetFields()},te=()=>{w.validateFields().then(t=>{ae.post(route("products.store-refill",m.id),t).then(s=>{A.success(r("Product refilled successfully")),g(!1),window.location.reload()}).catch(s=>{console.error("Refill error:",s),A.error(r("Failed to refill product"))})})},re=[{title:"",dataIndex:"primaryImageUrl",key:"image",width:80,render:(t,s)=>t?e.jsx(E,{shape:"square",size:64,src:e.jsx(oe,{src:t,alt:s.name,preview:!1})}):e.jsx(E,{shape:"square",size:64,icon:e.jsx(le,{})})},{title:r("Name"),dataIndex:"name",key:"name",...z("name"),render:(t,s)=>e.jsx(l,{href:route("products.show",s.id),children:e.jsx(ve,{strong:!0,className:"text-primary-600 hover:text-primary-800 cursor-pointer",children:t})})},{title:r("SKU"),dataIndex:"sku",key:"sku",...z("sku")},{title:r("Warehouse"),dataIndex:"warehouseName",key:"warehouseName",filters:(n==null?void 0:n.map(t=>({text:t.name,value:t.name})))||[],onFilter:(t,s)=>s.warehouseName===t},{title:r("Quantity"),dataIndex:"quantity",key:"quantity",sorter:(t,s)=>t.quantity-s.quantity,render:t=>e.jsx(de,{count:t,showZero:!0,overflowCount:9999,style:{backgroundColor:t<=0?"#f5222d":t<=5?"#faad14":"#52c41a",fontSize:"14px",padding:"0 8px"}})},{title:r("Unit Price"),dataIndex:"unit_price",key:"unit_price",sorter:(t,s)=>{const i=parseFloat(t.unit_price)||0,c=parseFloat(s.unit_price)||0;return i-c},render:t=>`ETB ${(parseFloat(t)||0).toFixed(2)}`},{title:r("Actions"),key:"action",width:150,fixed:"right",render:(t,s)=>y?e.jsxs(R,{size:"small",children:[e.jsx(x,{title:r("Refill"),children:e.jsx(o,{type:"default",icon:e.jsx($,{}),size:"small",onClick:()=>P(s)})}),e.jsx(T,{menu:{items:[{key:"1",label:e.jsx(l,{href:route("products.refill",s.id),children:r("Advanced Refill")}),icon:e.jsx(W,{})},{key:"2",label:e.jsx(l,{href:route("products.edit",s.id),children:r("Edit Details")}),icon:e.jsx(b,{})}]},trigger:["click"],children:e.jsx(o,{icon:e.jsx(M,{}),size:"small"})})]}):e.jsxs(R,{size:"small",children:[e.jsx(x,{title:r("View Details"),children:e.jsx(l,{href:route("products.show",s.id),children:e.jsx(o,{type:"primary",ghost:!0,icon:e.jsx(ue,{}),size:"small"})})}),e.jsx(x,{title:r("Edit"),children:e.jsx(l,{href:route("products.edit",s.id),children:e.jsx(o,{icon:e.jsx(b,{}),size:"small"})})}),e.jsx(x,{title:r("Refill"),children:e.jsx(o,{type:"default",icon:e.jsx($,{}),size:"small",onClick:()=>P(s)})}),e.jsx(T,{menu:{items:[{key:"1",label:e.jsx(l,{href:route("products.refill",s.id),children:r("Advanced Refill")}),icon:e.jsx(W,{})},{key:"2",label:e.jsx(l,{href:route("products.edit",s.id),children:r("Edit Details")}),icon:e.jsx(b,{})}]},trigger:["click"],children:e.jsx(o,{icon:e.jsx(M,{}),size:"small"})})]})}];return e.jsxs(ne,{user:j.user,header:e.jsx("h2",{className:"font-semibold text-xl text-gray-800 leading-tight",children:r("Products")}),children:[e.jsx(ie,{title:r("Products")}),e.jsx("div",{className:"py-12",children:e.jsx("div",{className:"max-w-7xl mx-auto sm:px-6 lg:px-8",children:e.jsxs("div",{className:"bg-white overflow-hidden shadow-sm sm:rounded-lg p-6",children:[e.jsxs("div",{className:"mb-6 flex justify-between items-center",children:[e.jsx("h1",{className:"text-2xl font-bold",children:r("Products")}),e.jsx(l,{href:route("products.create"),children:e.jsx(o,{type:"primary",icon:e.jsx(me,{}),children:r("Product")})})]}),e.jsx("div",{className:"mb-6 overflow-auto",children:e.jsxs(D,{activeKey:p,onChange:Z,type:"card",tabPosition:"top",className:"warehouse-tabs",tabBarGutter:8,children:[e.jsx(_,{tab:e.jsxs("span",{children:[e.jsx(pe,{}),r("All Warehouses")]})},"all"),n==null?void 0:n.map(t=>e.jsx(_,{tab:e.jsxs("span",{children:[e.jsx(he,{}),t.name]})},t.id))]})}),e.jsx(fe,{dataSource:Y,columns:re,rowKey:"id",pagination:{pageSize:10,showSizeChanger:!0,pageSizeOptions:["10","20","50"]},scroll:{x:1200},onRow:t=>({onClick:()=>{y&&(window.location.href=route("products.show",t.id))},style:{cursor:y?"pointer":"default"}})})]})})}),e.jsx(xe,{title:r("Refill Product"),open:U,onCancel:()=>g(!1),onOk:te,okText:r("Refill"),cancelText:r("Cancel"),children:e.jsxs(u,{form:w,layout:"vertical",children:[e.jsx(u.Item,{name:"quantity",label:r("Quantity to Add"),rules:[{required:!0,message:r("Please enter quantity")}],children:e.jsx(F,{min:1,style:{width:"100%"},placeholder:r("Enter quantity")})}),e.jsx(u.Item,{name:"unit_price",label:r("Unit Price"),rules:[{required:!0,message:r("Please enter unit price")}],initialValue:m==null?void 0:m.unit_price,children:e.jsx(F,{min:0,step:.01,style:{width:"100%"},placeholder:r("Enter unit price"),formatter:t=>`ETB ${t}`.replace(/\B(?=(\d{3})+(?!\d))/g,","),parser:t=>t.replace(/ETB\s?|(,*)/g,"")})}),e.jsx(u.Item,{name:"note",label:r("Note"),children:e.jsx(N.TextArea,{rows:3,placeholder:r("Enter any notes about this refill")})})]})})]})};export{rt as default};
